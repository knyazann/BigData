ubuntu@linux:~/BigData/hw$ python3 ./hw2_3/hw2_3.py
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
24/01/15 01:36:47 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
/home/ubuntu/.local/lib/python3.6/site-packages/pyspark/context.py:238: FutureWarning: Python 3.6 support is deprecated in Spark 3.2.
  FutureWarning
Среднее количество начала поездок и количество завершения поездок В ДЕНЬ:
+----------+------------------+------------------+                              
|station id|  mean start count|    mean end count|
+----------+------------------+------------------+
|      3175|63.785714285714285|62.892857142857146|
|       496|116.96428571428571|117.89285714285714|
|       471|31.071428571428573|31.178571428571427|
|      3179| 8.607142857142858| 8.928571428571429|
|       243|              21.0|29.428571428571427|
|       540| 85.96428571428571|             87.25|
|      3226|52.035714285714285|35.285714285714285|
|       392| 36.92857142857143| 39.32142857142857|
|      3352| 6.142857142857143| 6.357142857142857|
|       516|             37.25| 37.32142857142857|
|      3704|2.2857142857142856|               2.7|
|       251| 77.78571428571429| 77.53571428571429|
|      3490| 8.178571428571429| 8.107142857142858|
|      3425|21.785714285714285|22.535714285714285|
|       458|              94.0| 95.60714285714286|
|      3566| 4.678571428571429| 4.785714285714286|
|      3377|23.107142857142858|23.821428571428573|
|      3561| 5.821428571428571| 5.857142857142857|
|      3105|             15.75|16.107142857142858|
|      3042| 9.571428571428571| 9.392857142857142|
+----------+------------------+------------------+
only showing top 20 rows

Среднее количество начала поездок УТРОМ, ДНЕМ, ВЕЧЕРОМ, НОЧЬЮ
+----------------+-----------------+------------------+----------------------+-----------------------+
|start station id|start time of day|       mean starts|start station latitude|start station longitude|
+----------------+-----------------+------------------+----------------------+-----------------------+
|            null|            вечер|               1.5|                  null|                   null|
|            null|             день|               2.0|                  null|                   null|
|            null|             ночь|               2.0|                  null|                   null|
|              72|            вечер|14.148148148148149|             40.767273|              -73.99393|
|              72|             день|25.642857142857142|             40.767273|              -73.99393|
|              72|             ночь| 2.269230769230769|             40.767273|              -73.99393|
|              72|             утро|              24.0|             40.767273|              -73.99393|
|              79|            вечер|14.107142857142858|             40.719116|              -74.00667|
|              79|             день|18.535714285714285|             40.719116|              -74.00667|
|              79|             ночь|1.8235294117647058|             40.719116|              -74.00667|
|              79|             утро|10.821428571428571|             40.719116|              -74.00667|
|              82|            вечер| 6.185185185185185|             40.711174|              -74.00017|
|              82|             день| 9.107142857142858|             40.711174|              -74.00017|
|              82|             ночь|               1.2|             40.711174|              -74.00017|
|              82|             утро| 7.857142857142857|             40.711174|              -74.00017|
|              83|            вечер| 7.964285714285714|             40.683826|             -73.976326|
|              83|             день|11.592592592592593|             40.683826|             -73.976326|
|              83|             ночь|1.2222222222222223|             40.683826|             -73.976326|
|              83|             утро|3.4615384615384617|             40.683826|             -73.976326|
|             119|            вечер|1.5333333333333334|              40.69609|             -73.978035|
+----------------+-----------------+------------------+----------------------+-----------------------+
only showing top 20 rows

Среднее количество завершения поездок УТРОМ, ДНЕМ, ВЕЧЕРОМ, НОЧЬЮ
+--------------+---------------+------------------+--------------------+---------------------+
|end station id|end time of day|         mean ends|end station latitude|end station longitude|
+--------------+---------------+------------------+--------------------+---------------------+
|          null|          вечер|               1.5|                null|                 null|
|          null|           день|               2.0|                null|                 null|
|          null|           ночь|               2.0|                null|                 null|
|            72|          вечер|20.214285714285715|           40.767273|            -73.99393|
|            72|           день|23.571428571428573|           40.767273|            -73.99393|
|            72|           ночь|1.6111111111111112|           40.767273|            -73.99393|
|            72|           утро|21.857142857142858|           40.767273|            -73.99393|
|            79|          вечер|              7.75|           40.719116|            -74.00667|
|            79|           день|18.642857142857142|           40.719116|            -74.00667|
|            79|           ночь|1.0833333333333333|           40.719116|            -74.00667|
|            79|           утро|17.357142857142858|           40.719116|            -74.00667|
|            82|          вечер|              8.24|           40.711174|            -74.00017|
|            82|           день| 9.785714285714286|           40.711174|            -74.00017|
|            82|           ночь|               1.4|           40.711174|            -74.00017|
|            82|           утро| 5.857142857142857|           40.711174|            -74.00017|
|            83|          вечер|               6.0|           40.683826|           -73.976326|
|            83|           день|14.071428571428571|           40.683826|           -73.976326|
|            83|           ночь|               1.0|           40.683826|           -73.976326|
|            83|           утро|              13.5|           40.683826|           -73.976326|
|           119|          вечер| 2.263157894736842|            40.69609|           -73.978035|
+--------------+---------------+------------------+--------------------+---------------------+
only showing top 20 rows

Среднее количество начала и окончания поездок по временным диапазонам (СРЕДА):
+----------+-----------+------------------+------------------+                  
|station id|time of day|       mean starts|         mean ends|
+----------+-----------+------------------+------------------+
|        72|      вечер|              10.0|              14.0|
|        72|       день|              21.0|              16.5|
|        72|       ночь|              2.25|1.6666666666666667|
|        72|       утро|             34.25|             28.75|
|        79|      вечер|              13.0|               8.5|
|        79|       день|             18.25|              18.5|
|        79|       ночь|               1.5|               1.0|
|        79|       утро|             13.75|              25.5|
|        82|      вечер| 6.666666666666667| 8.333333333333334|
|        82|       день|              5.75|              9.25|
|        82|       ночь|               1.0|               1.0|
|        82|       утро|              8.75|               4.5|
|        83|      вечер|               7.0|               6.0|
|        83|       день|              6.75|              7.25|
|        83|       утро|               3.5|             20.25|
|       119|      вечер|               1.0|              1.75|
|       119|       день|3.3333333333333335|               9.0|
|       119|       ночь|               1.0|               1.0|
|       119|       утро|               5.5|              3.25|
|       120|      вечер|3.3333333333333335|              5.25|
+----------+-----------+------------------+------------------+
only showing top 20 rows

Среднее количество начала и окончания поездок по временным диапазонам (ВОСКРЕСЕНЬЕ):
+----------+-----------+------------------+------------------+                  
|station id|time of day|       mean starts|         mean ends|
+----------+-----------+------------------+------------------+
|        72|      вечер|              9.25|               8.2|
|        72|       день|             24.75|              25.6|
|        72|       ночь|               2.0|               1.0|
|        72|       утро|             10.75|               5.5|
|        79|      вечер|               7.0|               5.0|
|        79|       день|             16.75|              21.5|
|        79|       ночь|              2.75|               2.0|
|        79|       утро|               6.5|              9.25|
|        82|      вечер|              4.25|               5.0|
|        82|       день|               8.0|              9.75|
|        82|       ночь|               1.0|1.6666666666666667|
|        82|       утро|               6.5|              5.25|
|        83|      вечер|               5.5|               4.0|
|        83|       день|             19.75|              26.0|
|        83|       ночь|               1.0|               1.0|
|        83|       утро|3.3333333333333335|              7.75|
|       119|      вечер|               1.0|               1.0|
|       119|       день|              1.75|               3.0|
|       120|      вечер|              4.75|              7.75|
|       120|       день|             12.25|             12.75|
+----------+-----------+------------------+------------------+
only showing top 20 rows